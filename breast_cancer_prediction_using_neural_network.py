# -*- coding: utf-8 -*-
"""Breast_Cancer_PRediction_Using_Neural_network.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1SdzkKhpQXCX_IzfHFO8CYlUp7Zj-8QHg
"""



"""# *Below Project Is On Breast Cancer Prediction Using Neural Netwok *"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import sklearn.datasets
from sklearn.model_selection import train_test_split

breast_cancer_dataset = sklearn.datasets.load_breast_cancer()

print(breast_cancer_dataset)

data_frame = pd.DataFrame (breast_cancer_dataset.data,columns = breast_cancer_dataset.feature_names)

data_frame.head()

data_frame['label'] = breast_cancer_dataset.target

data_frame.tail()

data_frame.shape

data_frame.info()

data_frame.describe()

data_frame.isnull().sum()

data_frame.groupby('label').mean()

X = data_frame.drop(columns = 'label',axis = 1)
Y= data_frame['label']

X

Y

X_tarin,X_test,Y_train,Y_test = train_test_split(X,Y,random_state=42, test_size=0.2)

import tensorflow as tf
tf.random.set_seed(42)
from tensorflow import keras

model = keras.Sequential([
                          keras.layers.Flatten(input_shape=(30,)),
                          keras.layers.Dense(20,activation='relu'),
                          keras.layers.Dense(2,activation = 'sigmoid'),
                          ])

model.compile(optimizer='adam',
              loss= 'sparse_categorical_crossentropy',
              metrics =['accuracy']


)

history = model.fit(X_tarin,Y_train,epochs = 10)

X_train,X_test,Y_train,Y_test = train_test_split(X,Y,random_state=42,test_size=0.2)

from sklearn.preprocessing import StandardScaler

scaler = StandardScaler()
X_train_std = scaler.fit_transform(X_train)
X_test_std = scaler.transform(X_test)

print(X_train_std)

plt.plot(history.history['accuracy'])
plt.plot(history.history['val_accuracy'])

plt.title('Model Accuracy')
plt.ylabel('Accuracy')
plt.xlabel('Epoch')
plt.legend(['Training', 'Validation'], loc='lower right')
plt.show()

plt.plot(history.history['loss'])
plt.plot(history.history['val_loss'])

plt.title('Model loss')
plt.ylabel('loss')
plt.xlabel('Epoch')
plt.legend(['Training', 'Validation'], loc='upper right')
plt.show()

loss,accuracy = model.evaluate(X_test_std,Y_test)
print(accuracy)

Y_pred = model.predict(X_test_std)

print(Y_pred[0:4])

Y_pred_labels = [np.argmax(i) for i in Y_pred]
print(Y_pred_labels)

input_data = (18.63,	25.11,	124.8,	1088	,0.1064,	0.1887	,0.2319	,0.1244	,0.2183	,0.06197	,0.8307	,1.466	,5.574	,105	,0.006248	,0.03374	,0.05196	,0.01158	,0.02007	,0.00456	,23.15	,34.01	,160.5,	1670	,0.1491	,0.4257,	0.6133	,0.1848	,0.3444,	0.09782)
inputdata_as_numpyarray = np.asarray(input_data)
input_data_reshaped = inputdata_as_numpyarray.reshape(1,-1)

input_data_std= scaler.transform(input_data_reshaped)
prediction = model.predict(input_data_std)
print(prediction)
prediction_labels = [np.argmax(prediction)]
print(prediction_labels)

if (prediction_labels[0]==0):
  print("The Breast Cancer Is Maligenant")
else:
  print("The Breast Cancer Is Benign")

input_data = (13.05	,19.31	,82.61,	527.2,	0.0806,	0.03789,	0.000692	,0.004167	,0.1819,	0.05501	,0.404,	1.214,	2.595	,32.96	,0.007491,	0.008593,	0.000692	,0.004167	,0.0219	,0.00299	,14.23	,22.25	,90.24	,624.1	,0.1021	,0.06191	,0.001845	,0.01111	,0.2439	,0.06289)
input_data_std= scaler.transform(input_data_reshaped)
prediction = model.predict(input_data_std)
print(prediction)
prediction_labels = [np.argmax(prediction)]
print(prediction_labels)

if (prediction_labels[0]==0):
  print("The Breast Cancer Is Maligenant")
else:
  print("The Breast Cancer Is Benign")

